{"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Pexip Swift SDK"}]},{"type":"text","text":" utilizes "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/screencapturekit"},{"type":"text","text":" to capture screen content on macOS 12.3+ and "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/coregraphics\/quartz_window_services"},{"type":"text","text":" on older macOS versions."}]},{"anchor":"Implementation","level":2,"type":"heading","text":"Implementation"},{"anchor":"Retrieve-the-displays-and-windows-for-screen-capture","level":3,"type":"heading","text":"Retrieve the displays and windows for screen capture"},{"type":"codeListing","syntax":"swift","code":["let enumerator = ScreenMediaSource.createEnumerator()","displays = try await enumerator.getShareableDisplays()","windows = try await enumerator.getShareableWindows()","","\/\/ Choose first available display","let screenMediaSource = ScreenMediaSource.display(displays.first!)"]},{"anchor":"Start-screen-capture","level":3,"type":"heading","text":"Start screen capture"},{"type":"codeListing","syntax":"swift","code":["import PexipRTC","import PexipMedia","","let mediaConnectionFactory = WebRTCMediaConnectionFactory(logger: DefaultLogger.mediaWebRTC)","","\/\/ 1. Create a new screen media track.","let screenMediaTrack = mediaConnectionFactory.createScreenMediaTrack(","    mediaSource: screenMediaSource",")","","\/\/ 2. Start screen capture and send presentation video to all conference participants.","mediaConnection.setScreenMediaTrack(screenMediaTrack)","try await screenMediaTrack.startCapture(withVideoProfile: .presentationVeryHigh)"]},{"anchor":"Subscribe-to-status-updates","level":3,"type":"heading","text":"Subscribe to status updates"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Screen capture might be stopped due to different reasons, so it could be useful to subscribe to status updates from the screen media track."}]},{"type":"codeListing","syntax":"swift","code":["var isPresenting = false","","screenMediaTrack.capturingStatus.$isCapturing","    .receive(on: DispatchQueue.main)","    .sink { isCapturing in","        if !isCapturing && isPresenting {","            mediaConnection.setScreenMediaTrack(nil)","        }","","        isPresenting = isCapturing","    }","    .store(in: &cancellables)"]},{"anchor":"Handle-conference-events","level":3,"type":"heading","text":"Handle conference events"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Stop screen capture if presentation has been stolen by another participant."}]},{"type":"codeListing","syntax":"swift","code":["await conference.receiveEvents()","","conference.eventPublisher","    .sink { event in","        do {","            switch event {","            case .presentationStart(let message):","                screenMediaTrack.stopCapture()","                mediaConnection.setScreenMediaTrack(nil)","                try mediaConnection.receivePresentation(true)","            \/\/ ...","            }","        } catch {","            debugPrint(\"Cannot handle conference event, error: \\(error)\")","        }","    }","    .store(in: &cancellables)"]},{"anchor":"Stop-screen-capture","level":3,"type":"heading","text":"Stop screen capture"},{"type":"codeListing","syntax":"swift","code":["screenMediaTrack.stopCapture()","mediaConnection.setScreenMediaTrack(nil)"]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/pexipswiftsdk\/macosscreensharing"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/PexipSwiftSDK\/documentation\/PexipSwiftSDK\/macOSScreenSharing","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Stream desktop content like displays, apps, and windows in a conference call using "},{"type":"strong","inlineContent":[{"type":"text","text":"Pexip Swift SDK"}]},{"type":"text","text":"."}],"kind":"article","metadata":{"roleHeading":"Article","title":"Screen Sharing on macOS","role":"article","modules":[{"name":"Pexip Swift SDK"}]},"hierarchy":{"paths":[["doc:\/\/PexipSwiftSDK\/documentation\/PexipSwiftSDK"]]},"references":{"doc://PexipSwiftSDK/documentation/PexipSwiftSDK":{"role":"collection","title":"Pexip Swift SDK","abstract":[],"identifier":"doc:\/\/PexipSwiftSDK\/documentation\/PexipSwiftSDK","kind":"symbol","type":"topic","url":"\/documentation\/pexipswiftsdk"},"https://developer.apple.com/documentation/coregraphics/quartz_window_services":{"title":"Quartz Window Services API","titleInlineContent":[{"type":"text","text":"Quartz Window Services API"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/coregraphics\/quartz_window_services","url":"https:\/\/developer.apple.com\/documentation\/coregraphics\/quartz_window_services"},"https://developer.apple.com/documentation/screencapturekit":{"title":"ScreenCaptureKit","titleInlineContent":[{"type":"text","text":"ScreenCaptureKit"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/screencapturekit","url":"https:\/\/developer.apple.com\/documentation\/screencapturekit"}}}